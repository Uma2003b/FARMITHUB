<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Farmer Marketplace - AgriConnectHub</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Open Sans', sans-serif; background: #f9fafb; color: #333; }
    
    .header { background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%); padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: relative; }
    .header .logo { color: white; font-size: 1.5rem; font-weight: 700; text-decoration: none; }
    .header-buttons { display: flex; gap: 1rem; align-items: center; }
    .header-buttons a, .header-buttons button { background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; text-decoration: none; font-size: 0.9rem; transition: all 0.3s; }
    .header-buttons a:hover, .header-buttons button:hover { background: rgba(255,255,255,0.3); }
    
    .apps-dropdown { position: relative; }
    .apps-btn { background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem; }
    .dropdown-menu { position: absolute; top: 100%; right: 0; background: white; border-radius: 8px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); min-width: 300px; max-height: 450px; overflow-y: auto; z-index: 10000; display: none; margin-top: 0.5rem; }
    .dropdown-menu.show { display: block; }
    .dropdown-menu a { display: flex; align-items: center; gap: 0.8rem; padding: 0.8rem 1rem; color: #333; text-decoration: none; border-bottom: 1px solid #f0f0f0; }
    .dropdown-menu a:hover { background: #f5f5f5; }
    .dropdown-category { padding: 0.8rem 1rem; font-weight: 600; font-size: 0.8rem; color: #666; text-transform: uppercase; background: #f9f9f9; }
    
    .hero { background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%); color: white; padding: 2rem; text-align: center; }
    .hero h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    
    .container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
    
    .tabs { display: flex; gap: 1rem; margin-bottom: 2rem; border-bottom: 2px solid #e5e7eb; }
    .tab-btn { background: none; border: none; padding: 1rem 1.5rem; font-size: 1rem; font-weight: 600; color: #999; cursor: pointer; border-bottom: 3px solid transparent; }
    .tab-btn.active { color: #16a34a; border-bottom-color: #16a34a; }
    
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    
    .form-section { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    .form-section h2 { color: #16a34a; font-size: 1.3rem; margin-bottom: 1.5rem; }
    
    .form-group { margin-bottom: 1.2rem; }
    .form-group label { display: block; font-weight: 600; margin-bottom: 0.4rem; color: #1f2937; }
    .form-group input, .form-group select { width: 100%; padding: 0.8rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem; }
    .form-group input:focus, .form-group select:focus { outline: none; border-color: #16a34a; }
    
    .btn-submit { width: 100%; padding: 1rem; background: linear-gradient(135deg, #16a34a, #22c55e); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
    .btn-submit:hover { transform: translateY(-2px); }
    
    .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1.5rem; }
    .product-card { background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 10px; overflow: hidden; }
    .product-card:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
    
    .product-header { background: linear-gradient(135deg, #f0fdf4, #dcfce7); padding: 1rem; }
    .product-name { font-weight: 700; color: #16a34a; font-size: 1.1rem; margin-bottom: 0.3rem; }
    .product-seller { font-size: 0.85rem; color: #666; }
    
    .product-body { padding: 1rem; }
    .product-price { font-size: 1.5rem; font-weight: 700; color: #16a34a; margin-bottom: 1rem; }
    
    .btn-contact { width: 100%; padding: 0.8rem; background: #16a34a; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; margin-top: 1rem; }
    .btn-contact:hover { background: #22c55e; }
    
    .footer { background: linear-gradient(135deg, #2e7d32, #66bb6a); color: white; padding: 1.5rem; text-align: center; }
  </style>
</head>
<body>
  <header class="header">
    <a href="#" class="logo">ğŸŒ¾ AgriConnectHub</a>
    <div class="header-buttons">
      <div class="apps-dropdown">
        <button class="apps-btn" id="appsBtn">ğŸ“± Apps</button>
        <div class="dropdown-menu" id="appsMenu">
          <div class="dropdown-category">ğŸŒ¾ Farming Tools</div>
          <a href="/crop_recommendation/"><span>ğŸŒ±</span> Crop Recommendation</a>
          <a href="/crop_yield/"><span>ğŸ“Š</span> Yield Prediction</a>
          <a href="disease.html"><span>ğŸ”¬</span> Disease Detection</a>
          <a href="weather.html"><span>â›…</span> Weather Check</a>
          <a href="/crop_planning/"><span>ğŸ“…</span> Crop Planning</a>
          <a href="organic.html"><span>ğŸŒ¿</span> Organic Farming</a>
          <a href="plantation.html"><span>ğŸŒ³</span> Plantation Guide</a>
          <div class="dropdown-category">ğŸ“ˆ Market & Trade</div>
          <a href="/crop_price_tracker/crop_price_tracker"><span>ğŸ’°</span> Price Tracker</a>
          <a href="farmer.html"><span>ğŸ‘¥</span> Farmer Network</a>
          <a href="shopkeeper.html"><span>ğŸª‘</span> Shop Listings</a>
          <div class="dropdown-category">ğŸ“¢ Community</div>
          <a href="chat.html"><span>ğŸ¤–</span> AI Assistant</a>
          <a href="Forum/forum.html"><span>ğŸ’¬</span> Farmer Forum</a>
          <a href="./Labour_Alerts/templates/labour.html"><span>âš ï¸</span> Labour Alerts</a>
        </div>
      </div>
      <a href="/cropCalendar.html">ğŸ“… Calendar</a>
      <a href="/feed-back.html">ğŸ’¬ Feedback</a>
      <a href="#" onclick="logout()">ğŸšª Logout</a>
    </div>
  </header>

  <div class="hero">
    <h1>ğŸ›ï¸ Farmer Marketplace</h1>
    <p>Buy and sell agricultural products directly with farmers</p>
  </div>

  <div class="container">
    <div class="tabs">
      <button class="tab-btn active" data-tab="sell"><i class="fas fa-store"></i> Sell Products</button>
      <button class="tab-btn" data-tab="buy"><i class="fas fa-shopping-cart"></i> Buy Products</button>
    </div>

    <div id="sell" class="tab-content active">
      <div class="form-section">
        <h2>ğŸ“¦ List Your Product</h2>
        <form id="sellForm">
          <div class="form-group">
            <label>Your Name</label>
            <input type="text" id="sellerName" required />
          </div>
          <div class="form-group">
            <label>Contact Number</label>
            <input type="tel" id="sellerPhone" required />
          </div>
          <div class="form-group">
            <label>Product Name</label>
            <input type="text" id="productName" placeholder="e.g., Organic Tomatoes" required />
          </div>
          <div class="form-group">
            <label>Category</label>
            <select id="productCategory" required>
              <option value="">Select category...</option>
              <option value="Vegetables">ğŸ¥¬ Vegetables</option>
              <option value="Fruits">ğŸ Fruits</option>
              <option value="Grains">ğŸŒ¾ Grains</option>
              <option value="Pulses">ğŸ«˜ Pulses</option>
              <option value="Dairy">ğŸ¥› Dairy</option>
              <option value="Seeds">ğŸŒ± Seeds</option>
              <option value="Tools">ğŸ”§ Tools & Equipment</option>
            </select>
          </div>
          <div class="form-group">
            <label>Quantity Available</label>
            <input type="text" id="productQty" placeholder="e.g., 500 kg" required />
          </div>
          <div class="form-group">
            <label>Price per Unit</label>
            <input type="text" id="productPrice" placeholder="e.g., â‚¹50/kg" required />
          </div>
          <button type="submit" class="btn-submit"><i class="fas fa-plus"></i> List Product</button>
        </form>
      </div>

      <div style="margin-top: 2rem;">
        <h2 style="color: #16a34a; margin-bottom: 1.5rem;">ğŸ“‹ Your Listings</h2>
        <div id="sellProducts" class="product-grid">
          <div style="text-align: center; padding: 3rem 1rem; color: #999;">
            <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 1rem;"></i>
            <p>No products listed yet</p>
          </div>
        </div>
      </div>
    </div>

    <div id="buy" class="tab-content">
      <div class="form-section">
        <h2>ğŸ” Find Products</h2>
        <form id="buyForm">
          <div class="form-group">
            <label>Your Name</label>
            <input type="text" id="buyerName" required />
          </div>
          <div class="form-group">
            <label>Contact Number</label>
            <input type="tel" id="buyerPhone" required />
          </div>
          <div class="form-group">
            <label>Looking For</label>
            <input type="text" id="searchProduct" placeholder="e.g., Fresh Wheat" />
          </div>
          <button type="submit" class="btn-submit"><i class="fas fa-search"></i> Search Products</button>
        </form>
      </div>

      <div style="margin-top: 2rem;">
        <h2 style="color: #16a34a; margin-bottom: 1.5rem;">ğŸ›’ Available Products</h2>
        <div id="buyProducts" class="product-grid">
          <div style="text-align: center; padding: 3rem 1rem; color: #999;">
            <i class="fas fa-shopping-bag" style="font-size: 3rem; margin-bottom: 1rem;"></i>
            <p>No products available yet</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="footer"></footer>

  <script src="session.js"></script>
  <script>
    let sellProducts = JSON.parse(localStorage.getItem('sellProducts')) || [];
    let buyProducts = JSON.parse(localStorage.getItem('buyProducts')) || [];

    function displayProducts() {
      const sellDiv = document.getElementById('sellProducts');
      if (sellProducts.length === 0) {
        sellDiv.innerHTML = '<div style="text-align: center; padding: 3rem 1rem; color: #999;"><i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 1rem;"></i><p>No products listed yet</p></div>';
      } else {
        sellDiv.innerHTML = sellProducts.map(p => `
          <div class="product-card">
            <div class="product-header">
              <div class="product-name">${p.name}</div>
              <div class="product-seller">ğŸ‘¨ğŸŒ¾ ${p.seller}</div>
            </div>
            <div class="product-body">
              <div style="color: #999; font-size: 0.85rem; margin-bottom: 0.5rem;">${p.category}</div>
              <div style="color: #666; font-size: 0.9rem; margin-bottom: 0.5rem;">ğŸ“¦ ${p.qty}</div>
              <div class="product-price">${p.price}</div>
              <button class="btn-contact" type="button" onclick="showContact('${p.seller}', '${p.phone}')">Contact Seller</button>
            </div>
          </div>
        `).join('');
      }

      const buyDiv = document.getElementById('buyProducts');
      const search = document.getElementById('searchProduct').value.toLowerCase();
      const filtered = buyProducts.filter(p => !search || p.name.toLowerCase().includes(search));

      if (filtered.length === 0) {
        buyDiv.innerHTML = '<div style="text-align: center; padding: 3rem 1rem; color: #999;"><i class="fas fa-shopping-bag" style="font-size: 3rem; margin-bottom: 1rem;"></i><p>No products found</p></div>';
      } else {
        buyDiv.innerHTML = filtered.map(p => `
          <div class="product-card">
            <div class="product-header">
              <div class="product-name">${p.name}</div>
              <div class="product-seller">ğŸ‘¨ğŸŒ¾ ${p.seller}</div>
            </div>
            <div class="product-body">
              <div style="color: #999; font-size: 0.85rem; margin-bottom: 0.5rem;">${p.category}</div>
              <div style="color: #666; font-size: 0.9rem; margin-bottom: 0.5rem;">ğŸ“¦ ${p.qty}</div>
              <div class="product-price">${p.price}</div>
              <button class="btn-contact" type="button" onclick="showContact('${p.seller}', '${p.phone}')">Contact Seller</button>
            </div>
          </div>
        `).join('');
      }
    }

    function showContact(name, phone) {
      Swal.fire({
        title: 'Contact ' + name,
        text: 'Phone: ' + phone,
        icon: 'info',
        confirmButtonText: 'Copy Number'
      }).then(() => {
        navigator.clipboard.writeText(phone);
        Swal.fire('Copied!', 'Phone number copied', 'success');
      });
    }

    function logout() {
      window.logout();
    }

    document.getElementById('sellForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const product = {
        id: Date.now(),
        name: document.getElementById('productName').value,
        seller: document.getElementById('sellerName').value,
        phone: document.getElementById('sellerPhone').value,
        category: document.getElementById('productCategory').value,
        qty: document.getElementById('productQty').value,
        price: document.getElementById('productPrice').value
      };
      sellProducts.push(product);
      buyProducts.push(product);
      localStorage.setItem('sellProducts', JSON.stringify(sellProducts));
      localStorage.setItem('buyProducts', JSON.stringify(buyProducts));
      document.getElementById('sellForm').reset();
      displayProducts();
      Swal.fire('Success!', 'Product listed successfully', 'success');
    });

    document.getElementById('buyForm').addEventListener('submit', (e) => {
      e.preventDefault();
      displayProducts();
    });

    document.getElementById('searchProduct').addEventListener('input', () => {
      displayProducts();
    });

    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');
      });
    });

    document.addEventListener('DOMContentLoaded', () => {
      displayProducts();
      
      const appsBtn = document.getElementById('appsBtn');
      const appsMenu = document.getElementById('appsMenu');
      appsBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        appsMenu.classList.toggle('show');
      });
      appsMenu.querySelectorAll('a').forEach(a => {
        a.addEventListener('click', () => appsMenu.classList.remove('show'));
      });
      document.addEventListener('click', (e) => {
        if (e.target !== appsBtn && !appsMenu.contains(e.target)) {
          appsMenu.classList.remove('show');
        }
      });
    });
  </script>
</body>
</html>
