<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/>
    <meta name="description" content="AgriConnectHub- Empowering Agriculture Through Technology."/>
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' https://generativelanguage.googleapis.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; font-src 'self' https://cdnjs.cloudflare.com https://fonts.googleapis.com https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://generativelanguage.googleapis.com;"
    />
    <title>AI ChatBot - AgriConnectHub</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="main.css" />
    <link rel="stylesheet" href="theme.css" />
    <link rel="stylesheet" href="chat.css" />
    
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
      /* Added styles for light green color on specified text */

      .chat-header h2 {
        color: var(--light-green); /* Light green */
      }

      .logo h1 {
        color: var(--light-green); /* Light green for AgriBot */
      }
    </style>
  </head>
  <body>
    <div class="header-nav-wrapper">
      <header class="uniform-header">
        <div class="brand">
          <h2>Welcome to AgriConnectHub</h2>
        </div>
        <div class="header-buttons">
          <a href="cropCalendar.html" class="calendar-button" title="Crop Calendar">
            <span class="calendar-icon">üìÖ</span>
            Calendar
          </a>
          <a href="feed-back.html" class="feedback-button">Feedback</a>
          <a href="#" class="logout-button" onclick="showLogoutConfirmation()">Logout</a>
          <select id="languageSelector" onchange="changeLanguage()">
            <option value="en" selected>English</option>
            <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
          </select>
          <button class="theme-toggle" aria-label="Toggle dark/light mode">
            <i class="fas fa-sun sun-icon"></i>
            <i class="fas fa-moon moon-icon"></i>
            <span class="theme-text">Light</span>
          </button>
        </div>
        <script>
          function changeLanguage() {
            const selector = document.getElementById('languageSelector');
            const selectedLang = selector.value;
            if (selectedLang === 'en') {
              window.location.href = 'chat.html';
            } else if (selectedLang === 'te') {
              window.location.href = 'chat_telugu.html';
            }
          }
        </script>
      </header>

      <nav>
        <ul>
          <li><a href="/crop_recommendation/">üå± Crop Recommendation</a></li>
          <li><a href="/crop_yield/">üìä Yield Prediction</a></li>
          <li><a href="disease.html">üî¨ Disease Prediction</a></li>
          <li><a href="organic.html">üåø Organic Farming</a></li>
          <li><a href="farmer.html">üë• Farmer Network</a></li>
          <li><a href="weather.html">‚õÖ Weather Check</a></li>
          <li><a href="shopkeeper.html">üè™ Shopkeeper Listings</a></li>
          <li><a href="chat.html">ü§ñ ChatBot</a></li>
          <li><a href="plantation.html">üå≥ Plantation</a></li>
          <li><a href="/crop_planning/">üìÖ Crop Planning</a></li>
          <li><a href="./Labour_Alerts/templates/labour.html">‚ö† Labour Alerts</a></li>
          <li><a href="/sugarcane_frp/">üçØ Sugarcane FRP</a></li>
          <li><a href="/district_procurement/">üì¶ District Procurement</a></li>
        </ul>
      </nav>
    </div>

    <main>
      <div id="chat-container">
        <div class="chat-header">
          <i class="fas fa-robot"></i>
          <h2>Ask me anything about agriculture, crops, or farming techniques</h2>
        </div>

        <div id="chat-window">
          <div class="welcome-message">
            <h3><i class="fas fa-leaf"></i> Welcome to AgriConnectHub Assistant!</h3>
            <p>
              I'm powered by Google Gemini AI to help with all your farming
              questions.
            </p>

            <div class="suggestions">
              <div class="suggestion">Best crops for this season?</div>
              <div class="suggestion">Organic pest control methods</div>
              <div class="suggestion">Water conservation techniques</div>
              <div class="suggestion">Soil health improvement</div>
            </div>
          </div>
        </div>

        <form id="chat-form">
          <div class="input-container">
            <input
              type="text"
              id="chat-input"
              placeholder="Ask about crops, weather, fertilizers..."
              aria-label="Chat input"
              autofocus
              required
            />
          </div>
          <button type="submit" id="send-button">
            <i class="fas fa-paper-plane"></i> Send
          </button>
        </form>
      </div>
    </main>
    <script src="chat.js"></script>
    <script src="nav.js"></script>
    <script src="auth.js"></script>
    <script src="theme.js"></script>
    
    <script>
      // Check authentication on page load
      document.addEventListener('DOMContentLoaded', () => {
        if (!window.authManager.isLoggedIn()) {
          window.location.href = '/login';
          return;
        }

        const currentUser = window.authManager.getCurrentUser();
        if (currentUser) {
          // Update header to show user name
          const headerTitle = document.querySelector('header h2');
          if (headerTitle) {
            headerTitle.textContent = `Welcome to AgriConnectHub, ${currentUser.fullname}!`;
          }
        }
      });

      // Logout confirmation function
      function showLogoutConfirmation() {
        Swal.fire({
          title: 'Confirm Logout',
          text: 'Are you sure you want to logout?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#d33',
          cancelButtonColor: '#3085d6',
          confirmButtonText: 'Yes, logout',
          cancelButtonText: 'Cancel'
        }).then((result) => {
          if (result.isConfirmed) {
            const logoutResult = window.authManager.logout();
            if (logoutResult.success) {
              Swal.fire({
                title: 'Logged Out!',
                text: logoutResult.message,
                icon: 'success',
                timer: 2000,
                showConfirmButton: false
              }).then(() => {
                // Redirect to index.html after logout
                window.location.href = '/';
              });
            } else {
              Swal.fire({
                title: 'Error!',
                text: logoutResult.message,
                icon: 'error'
              });
            }
          }
        });
      }
    </script>
    <style>
      .site-footer {background: linear-gradient(135deg,#2e7d32,#66bb6a); color:#fff; margin-top:auto; padding: 2rem 1.25rem;}
      .site-footer .footer-inner {max-width:1200px;margin:0 auto; display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:1.5rem; align-items:flex-start;}
      .footer-brand {display:flex;flex-direction:column;gap:.5rem;align-items: center;}
      .footer-logo {width:48px;height:48px;border-radius:8px;object-fit:cover;background:#fff;padding:4px}
      .site-footer h3,.site-footer h4{margin:0 0 .5rem 0}
      .site-footer p {margin:0;opacity:0.9}
      .site-footer ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column}
      .site-footer a{color:#fff;text-decoration:none;opacity:0.9;width:max-content;background-color: none;}
      .site-footer a:hover{opacity:1;text-decoration:underline}
      .footer-links{display:flex;flex-direction:column;align-items: center;}
    </style>
    <footer class="site-footer">
      <div class="footer-inner">
        <div class="footer-brand">
          <h3>AgriConnectHub</h3>
          <p>Empowering India's Farming Future</p>
        </div>
        <div class="footer-links">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="main.html">Dashboard</a></li>
            <li><a href="feed-back.html">Feedback</a></li>
            <li><a href="chat.html">AI Assistant</a></li>
          </ul>
        </div>
        <div class="footer-links">
          <h4>Tools</h4>
          <ul>
    <li><a href="/crop_recommendation/">Crop Recommendation</a></li>
            <li><a href="Crop Yield Prediction/crop_yield_app/templates/index.html">Yield Prediction</a></li>
            <li><a href="Disease prediction/template/index.html">Disease Detector</a></li>
            <li><a href="Crop_Planning/templates/cropplan.html">Crop Planner</a></li>
          </ul>
        </div>
      </div>
      <p style="margin-top: 2rem; opacity: 0.8">
        &copy; 2025 AgriConnectHub
      </p>
    </footer>
  </body>
</html>

